# 카카오맵 연동 테스트 가이드

## 🧪 테스트 방법

### 1. 데이터베이스 마이그레이션 실행
Supabase SQL Editor에서 다음 스크립트를 실행하세요:

```sql
-- events 테이블에 location_data 컬럼 추가
ALTER TABLE events 
ADD COLUMN location_data JSONB;

-- 성능 최적화를 위한 인덱스 생성
CREATE INDEX idx_events_location_data ON events USING GIN (location_data);
```

### 2. 새로운 일정 생성 테스트

#### **방법 1: 카카오맵 검색으로 일정 생성**
1. 캘린더에서 "일정 추가" 버튼 클릭
2. 제목 입력 (예: "강남역 모임")
3. **"지도에서 검색"** 버튼 클릭
4. 카카오맵에서 장소 검색 및 선택
5. 일정 저장

#### **방법 2: 기존 일정 수정**
1. 기존 일정 클릭하여 상세 모달 열기
2. "수정" 버튼 클릭
3. **"지도에서 검색"** 버튼으로 장소 재선택
4. 수정 완료

### 3. 카카오맵 연동 버튼 확인

#### **새로 생성한 일정 (locationData 있음)**
- **"지도 보기"** 버튼: 정확한 위치로 카카오맵 연결
- **"길찾기"** 버튼: 현재 위치에서 목적지까지 길찾기

#### **기존 일정 (locationData 없음)**
- **"지도에서 검색"** 버튼: 장소명으로 카카오맵 검색
- **"길찾기"** 버튼: 장소명으로 길찾기

### 4. 디버깅 정보 확인

개발 모드에서는 일정 상세 모달에서 다음 정보를 확인할 수 있습니다:
- `locationData`: 저장된 장소 상세 정보
- `isValid`: locationData 유효성 여부

## 🔍 문제 해결

### 문제 1: 버튼이 전혀 표시되지 않음
**원인**: `event.location`이 없음
**해결**: 일정에 장소 정보가 있는지 확인

### 문제 2: "지도에서 검색" 버튼만 표시됨
**원인**: `locationData`가 없음 (기존 일정)
**해결**: 일정 수정 시 "지도에서 검색"으로 장소 재선택

### 문제 3: 카카오맵이 열리지 않음
**원인**: 팝업 차단 또는 잘못된 URL
**해결**: 
1. 팝업 차단 해제
2. 브라우저 콘솔에서 오류 확인
3. URL 형식 확인

## 📱 테스트 시나리오

### 시나리오 1: 완전한 새 일정
1. 새 일정 생성
2. 카카오맵으로 장소 검색 및 선택
3. 일정 저장
4. 일정 상세에서 "지도 보기" 및 "길찾기" 버튼 확인

### 시나리오 2: 기존 일정 업그레이드
1. 기존 일정 수정
2. "지도에서 검색"으로 장소 재선택
3. 수정 완료
4. 일정 상세에서 정확한 위치 버튼 확인

### 시나리오 3: 기존 일정 (업그레이드 안함)
1. 기존 일정 그대로 유지
2. 일정 상세에서 "지도에서 검색" 버튼 확인
3. 버튼 클릭하여 카카오맵 검색 확인

## ✅ 성공 기준

- [ ] 모든 일정에서 카카오맵 연동 버튼 표시
- [ ] 새 일정: "지도 보기" 및 "길찾기" 버튼 작동
- [ ] 기존 일정: "지도에서 검색" 및 "길찾기" 버튼 작동
- [ ] 카카오맵이 새 탭에서 정상적으로 열림
- [ ] 길찾기 기능이 정상적으로 작동

## 🚨 알려진 제한사항

1. **기존 일정**: `locationData`가 없어서 정확한 위치 연결 불가
2. **장소명 검색**: 정확하지 않은 장소명의 경우 검색 결과가 부정확할 수 있음
3. **모바일**: 일부 모바일 브라우저에서 카카오맵 앱 연동 제한

## 🔧 추가 개선 사항

1. **기존 일정 마이그레이션**: 기존 일정의 location을 locationData로 변환
2. **장소명 정규화**: 일관된 장소명 형식 적용
3. **오프라인 지원**: 기본 장소 정보 표시
